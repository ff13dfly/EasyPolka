(()=>{var K=(F,C)=>()=>(C||F((C={exports:{}}).exports,C),C.exports);var V=K((G,W)=>{(()=>{var F={"./lib/loader.js":(E,y)=>{let x=null,h=null,m={getLibs:(p,v,c,n)=>{c||(c={}),n||(n=[]);let f=p.shift(),t=(Array.isArray(f)?f[0]:f).toLocaleLowerCase(),A=Array.isArray(f)?f[1]:0;if(c[t])return m.getLibs(p,v,c,n);m.getAnchor(t,A,(r,e)=>{if(c[r]=e||{error:"no such anchor"},!e.protocol||!e.protocol.ext&&!e.protocol.lib)n.push(r);else{let a={entry:r,lib:e.protocol&&e.protocol.lib?e.protocol.lib:[],ext:e.protocol&&e.protocol.ext?e.protocol.ext:[]};n.push(a)}if(e.protocol&&e.protocol.ext)for(let a=e.protocol.ext.length;a>0;a--)p.unshift(e.protocol.ext[a-1]);if(e.protocol&&e.protocol.lib)for(let a=e.protocol.lib.length;a>0;a--)p.unshift(e.protocol.lib[a-1]);if(p.length===0)return v&&v(c,n);m.getLibs(p,v,c,n)})},getAnchor:(p,v,c)=>{if(!p)return c&&c(p,"");(v===0?x:h)(p,f=>{if(!f||!f.owner)return c&&c(p,"");if(!f.empty){let t={key:f.name,raw:f.raw,protocol:f.protocol};return c&&c(p,t)}})},decodeLib:p=>{let v={type:"error",data:""};if(p.error)return v.error=p.error,v;if(!p.protocol)return v.error="Unexcept data format",v;let c=p.protocol;return c.fmt?(v.type=c.fmt,p.raw.substr(0,2).toLowerCase()==="0x"?v.data=decodeURIComponent(p.raw.slice(2).replace(/\s+/g,"").replace(/[0-9a-f]{2}/g,"%$&")):v.data=p.raw,v):(v.error="Anchor format lost",v)},getComplexOrder:(p,v,c,n)=>{if(c||(c=[]),n||(n=[]),v[p]===!0&&n.length===0)return c;let f=v[p],t=n.length!==0?n[n.length-1]:null,A=t!==null&&t.name===p?n.pop():null;if(f.lib&&f.lib.length>0){if(A===null)for(let r=0;r<f.lib.length;r++){let e=f.lib[r];if(v[e]===!0)c.push(e);else return n.push({lib:r,name:p}),m.getComplexOrder(e,v,c,n)}else if(A.lib!==void 0&&A.lib!==f.lib.length)for(let r=A.lib+1;r<f.lib.length;r++){let e=f.lib[r];if(v[e]===!0)c.push(e);else return n.push({lib:r,name:p}),m.getComplexOrder(e,v,c,n)}}if(A===null&&c.push(p),f.ext&&f.ext.length>0)if(A!==null){if(A.ext!==void 0&&A.ext!==f.ext.length)for(let r=A.ext+1;r<f.ext.length;r++){let e=f.ext[r];if(v[e]===!0)c.push(e);else return n.push({ext:r,name:p}),m.getComplexOrder(e,v,c,n)}}else for(let r=0;r<f.ext.length;r++){let e=f.ext[r];if(v[e]===!0)c.push(e);else return n.push({ext:r,name:p}),m.getComplexOrder(e,v,c,n)}if(n.length!==0){let r=n[n.length-1];return m.getComplexOrder(r.name,v,c,n)}return c},mergeOrder:p=>{let v={},c={},n={},f=[];for(let t=0;t<p.length;t++){let A=p[t];typeof A!="string"&&A.entry!==void 0?(v[A.entry]=!0,c[A.entry]=A):c[A]=!0}for(let t=0;t<p.length;t++){let A=p[t];if(typeof A=="string"||A instanceof String){if(n[A])continue;f.push(A),n[A]=!0}else{if(A.lib&&A.lib.length>0)for(let r=0;r<A.lib.length;r++){let e=A.lib[r];if(!n[e])if(v[e]){let a=m.getComplexOrder(e,c);console.log(`${e}:${JSON.stringify(a)}`);for(let s=0;s<a.length;s++){let d=a[s];n[d]||(f.push(d),n[d]=!0)}}else f.push(e),n[e]=!0}if(n[A.entry]||(f.push(A.entry),n[A.entry]=!0),A.ext&&A.ext.length>0)for(let r=0;r<A.ext.length;r++){let e=A.ext[r];if(!n[e])if(v[e]){let a=m.getComplexOrder(e,c);for(let s=0;s<a.length;s++){let d=a[s];n[d]||(f.push(d),n[d]=!0)}}else f.push(e),n[e]=!0}}}return f},regroupCode:(p,v)=>{let c=m.decodeLib,n="",f="",t={},A={},r=!1,e=m.mergeOrder(v);for(let a=0;a<e.length;a++){let s=e[a];if(t[s])continue;let d=p[s],l=c(d);if(t[s]=!0,l.error){A[s]=l.error,r=!0;continue}n+=l.type==="js"?l.data:"",f+=l.type==="css"?l.data:""}return{js:n,css:f,failed:A,order:e,error:r}}};y.Loader=(p,v,c)=>{x=v.search,h=v.target,m.getLibs(p,c)},y.Libs=(p,v,c)=>{x=v.search,h=v.target,m.getLibs(p,(n,f)=>{let t=m.regroupCode(n,f);return c&&c(t)})}},"./node_modules/charenc/charenc.js":E=>{var y={utf8:{stringToBytes:function(x){return y.bin.stringToBytes(unescape(encodeURIComponent(x)))},bytesToString:function(x){return decodeURIComponent(escape(y.bin.bytesToString(x)))}},bin:{stringToBytes:function(x){for(var h=[],m=0;m<x.length;m++)h.push(x.charCodeAt(m)&255);return h},bytesToString:function(x){for(var h=[],m=0;m<x.length;m++)h.push(String.fromCharCode(x[m]));return h.join("")}}};E.exports=y},"./node_modules/crypt/crypt.js":E=>{(function(){var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x={rotl:function(h,m){return h<<m|h>>>32-m},rotr:function(h,m){return h<<32-m|h>>>m},endian:function(h){if(h.constructor==Number)return x.rotl(h,8)&16711935|x.rotl(h,24)&4278255360;for(var m=0;m<h.length;m++)h[m]=x.endian(h[m]);return h},randomBytes:function(h){for(var m=[];h>0;h--)m.push(Math.floor(Math.random()*256));return m},bytesToWords:function(h){for(var m=[],p=0,v=0;p<h.length;p++,v+=8)m[v>>>5]|=h[p]<<24-v%32;return m},wordsToBytes:function(h){for(var m=[],p=0;p<h.length*32;p+=8)m.push(h[p>>>5]>>>24-p%32&255);return m},bytesToHex:function(h){for(var m=[],p=0;p<h.length;p++)m.push((h[p]>>>4).toString(16)),m.push((h[p]&15).toString(16));return m.join("")},hexToBytes:function(h){for(var m=[],p=0;p<h.length;p+=2)m.push(parseInt(h.substr(p,2),16));return m},bytesToBase64:function(h){for(var m=[],p=0;p<h.length;p+=3)for(var v=h[p]<<16|h[p+1]<<8|h[p+2],c=0;c<4;c++)p*8+c*6<=h.length*8?m.push(y.charAt(v>>>6*(3-c)&63)):m.push("=");return m.join("")},base64ToBytes:function(h){h=h.replace(/[^A-Z0-9+\/]/ig,"");for(var m=[],p=0,v=0;p<h.length;v=++p%4)v!=0&&m.push((y.indexOf(h.charAt(p-1))&Math.pow(2,-2*v+8)-1)<<v*2|y.indexOf(h.charAt(p))>>>6-v*2);return m}};E.exports=x})()},"./node_modules/is-buffer/index.js":E=>{E.exports=function(h){return h!=null&&(y(h)||x(h)||!!h._isBuffer)};function y(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}function x(h){return typeof h.readFloatLE=="function"&&typeof h.slice=="function"&&y(h.slice(0,0))}},"./node_modules/md5/md5.js":(E,y,x)=>{(function(){var h=x("./node_modules/crypt/crypt.js"),m=x("./node_modules/charenc/charenc.js").utf8,p=x("./node_modules/is-buffer/index.js"),v=x("./node_modules/charenc/charenc.js").bin,c=function(n,f){n.constructor==String?f&&f.encoding==="binary"?n=v.stringToBytes(n):n=m.stringToBytes(n):p(n)?n=Array.prototype.slice.call(n,0):!Array.isArray(n)&&n.constructor!==Uint8Array&&(n=n.toString());for(var t=h.bytesToWords(n),A=n.length*8,r=1732584193,e=-271733879,a=-1732584194,s=271733878,d=0;d<t.length;d++)t[d]=(t[d]<<8|t[d]>>>24)&16711935|(t[d]<<24|t[d]>>>8)&4278255360;t[A>>>5]|=128<<A%32,t[(A+64>>>9<<4)+14]=A;for(var l=c._ff,i=c._gg,u=c._hh,o=c._ii,d=0;d<t.length;d+=16){var _=r,g=e,b=a,w=s;r=l(r,e,a,s,t[d+0],7,-680876936),s=l(s,r,e,a,t[d+1],12,-389564586),a=l(a,s,r,e,t[d+2],17,606105819),e=l(e,a,s,r,t[d+3],22,-1044525330),r=l(r,e,a,s,t[d+4],7,-176418897),s=l(s,r,e,a,t[d+5],12,1200080426),a=l(a,s,r,e,t[d+6],17,-1473231341),e=l(e,a,s,r,t[d+7],22,-45705983),r=l(r,e,a,s,t[d+8],7,1770035416),s=l(s,r,e,a,t[d+9],12,-1958414417),a=l(a,s,r,e,t[d+10],17,-42063),e=l(e,a,s,r,t[d+11],22,-1990404162),r=l(r,e,a,s,t[d+12],7,1804603682),s=l(s,r,e,a,t[d+13],12,-40341101),a=l(a,s,r,e,t[d+14],17,-1502002290),e=l(e,a,s,r,t[d+15],22,1236535329),r=i(r,e,a,s,t[d+1],5,-165796510),s=i(s,r,e,a,t[d+6],9,-1069501632),a=i(a,s,r,e,t[d+11],14,643717713),e=i(e,a,s,r,t[d+0],20,-373897302),r=i(r,e,a,s,t[d+5],5,-701558691),s=i(s,r,e,a,t[d+10],9,38016083),a=i(a,s,r,e,t[d+15],14,-660478335),e=i(e,a,s,r,t[d+4],20,-405537848),r=i(r,e,a,s,t[d+9],5,568446438),s=i(s,r,e,a,t[d+14],9,-1019803690),a=i(a,s,r,e,t[d+3],14,-187363961),e=i(e,a,s,r,t[d+8],20,1163531501),r=i(r,e,a,s,t[d+13],5,-1444681467),s=i(s,r,e,a,t[d+2],9,-51403784),a=i(a,s,r,e,t[d+7],14,1735328473),e=i(e,a,s,r,t[d+12],20,-1926607734),r=u(r,e,a,s,t[d+5],4,-378558),s=u(s,r,e,a,t[d+8],11,-2022574463),a=u(a,s,r,e,t[d+11],16,1839030562),e=u(e,a,s,r,t[d+14],23,-35309556),r=u(r,e,a,s,t[d+1],4,-1530992060),s=u(s,r,e,a,t[d+4],11,1272893353),a=u(a,s,r,e,t[d+7],16,-155497632),e=u(e,a,s,r,t[d+10],23,-1094730640),r=u(r,e,a,s,t[d+13],4,681279174),s=u(s,r,e,a,t[d+0],11,-358537222),a=u(a,s,r,e,t[d+3],16,-722521979),e=u(e,a,s,r,t[d+6],23,76029189),r=u(r,e,a,s,t[d+9],4,-640364487),s=u(s,r,e,a,t[d+12],11,-421815835),a=u(a,s,r,e,t[d+15],16,530742520),e=u(e,a,s,r,t[d+2],23,-995338651),r=o(r,e,a,s,t[d+0],6,-198630844),s=o(s,r,e,a,t[d+7],10,1126891415),a=o(a,s,r,e,t[d+14],15,-1416354905),e=o(e,a,s,r,t[d+5],21,-57434055),r=o(r,e,a,s,t[d+12],6,1700485571),s=o(s,r,e,a,t[d+3],10,-1894986606),a=o(a,s,r,e,t[d+10],15,-1051523),e=o(e,a,s,r,t[d+1],21,-2054922799),r=o(r,e,a,s,t[d+8],6,1873313359),s=o(s,r,e,a,t[d+15],10,-30611744),a=o(a,s,r,e,t[d+6],15,-1560198380),e=o(e,a,s,r,t[d+13],21,1309151649),r=o(r,e,a,s,t[d+4],6,-145523070),s=o(s,r,e,a,t[d+11],10,-1120210379),a=o(a,s,r,e,t[d+2],15,718787259),e=o(e,a,s,r,t[d+9],21,-343485551),r=r+_>>>0,e=e+g>>>0,a=a+b>>>0,s=s+w>>>0}return h.endian([r,e,a,s])};c._ff=function(n,f,t,A,r,e,a){var s=n+(f&t|~f&A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._gg=function(n,f,t,A,r,e,a){var s=n+(f&A|t&~A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._hh=function(n,f,t,A,r,e,a){var s=n+(f^t^A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._ii=function(n,f,t,A,r,e,a){var s=n+(t^(f|~A))+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._blocksize=16,c._digestsize=16,E.exports=function(n,f){if(n==null)throw new Error("Illegal argument "+n);var t=h.wordsToBytes(c(n,f));return f&&f.asBytes?t:f&&f.asString?v.bytesToString(t):h.bytesToHex(t)}})()},"./src/auth.js":(E,y,x)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.checkTrust=y.checkAuth=y.easyAuth=void 0;var h=x("./node_modules/md5/md5.js"),m=function(c,n,f){};y.easyAuth=m;var p=function(c,n,f){var t={list:null,anchor:null};return n.auth?typeof n.auth=="string"||Array.isArray(n.auth)?t.anchor=n.auth:t.list=n.auth:n.salt&&(t.anchor=h(c+n.salt[0])),f&&f(t)};y.checkAuth=p;var v=function(c,n,f){var t={list:null,anchor:null};return n.trust?typeof n.trust=="string"||Array.isArray(n.trust)?t.anchor=n.trust:t.list=n.trust:n.salt&&(t.anchor=h(c+n.salt[0])),f&&f(t)};y.checkTrust=v},"./src/decoder.js":(E,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.linkDecoder=y.linkCreator=void 0;var x={check:!1,utf8:!0,pre:"anchor://"},h={getParams:function(v){for(var c={},n=v.split("&"),f=0;f<n.length;f++){var t=n[f],A=t.split("=");if(A.length!==2)return{error:"error parameter"};c[A[0]]=A[1]}return c},combineParams:function(v){if(!v)return"";var c=[];for(var n in v)c.push("".concat(n,"=").concat(v[n]));return c.length===0?"":c.join("&")}},m=function(v,c){var n=h.combineParams(c);return Array.isArray(v)?v[1]!==0?"".concat(x.pre).concat(v[0],"/").concat(v[1]).concat(n&&"?"+n):"".concat(x.pre).concat(v[0]).concat(n&&"?"+n):"".concat(x.pre).concat(v).concat(n&&"?"+n)};y.linkCreator=m;var p=function(v){var c={location:["",0]},n=v.toLocaleLowerCase(),f=x.pre;if(n.length<=f.length+1)return{error:"invalid string"};var t=n.substring(0,f.length);if(t!==f)return{error:"invalid protocol"};var A=n.substring(f.length,n.length),r=A.split("?");if(r.length>2)return{error:"error request, please check anchor name"};var e=r.length!==1;if(e){var a=h.getParams(r[1]);if(a.error)return a;c.param=h.getParams(r[1])}A=r[0];for(var s=A.split("/"),d=[],l=0;l<s.length;l++)s[l]!==""&&d.push(s[l]);if(d.length===1)c.location[0]=d[0],c.location[1]=0;else{var i=d.pop(),u=parseInt(i);if(isNaN(u))return{error:"block number error"};c.location[1]=u,c.location[0]=d.join("/")}return c};y.linkDecoder=p},"./src/hide.js":(E,y,x)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.checkHide=y.easyHide=void 0;var h=x("./node_modules/md5/md5.js"),m=function(v){};y.easyHide=m;var p=function(v,c,n){var f={list:null,anchor:null};return c.hide?typeof c.hide=="string"?f.anchor=c.hide:Array.isArray(c.hide)&&(f.list=c.hide):c.salt&&(f.anchor=h(v+c.salt[1])),n&&n(f)};y.checkHide=p},"./src/protocol.js":(E,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.relatedIndex=y.keysApp=y.codeType=y.formatType=y.rawType=y.errorLevel=void 0;var x;(function(n){n.ERROR="error",n.WARN="warning",n.UNEXCEPT="unexcept"})(x=y.errorLevel||(y.errorLevel={}));var h;(function(n){n.DATA="data",n.APP="app",n.LIB="lib",n.NONE="unknow"})(h=y.rawType||(y.rawType={}));var m;(function(n){n.JAVASCRIPT="js",n.CSS="css",n.MARKDOWN="md",n.JSON="json",n.MIX="mix",n.NONE=""})(m=y.formatType||(y.formatType={}));var p;(function(n){n.ASCII="ascii",n.UTF8="utf8",n.HEX="hex",n.NONE=""})(p=y.codeType||(y.codeType={}));var v;(function(n){})(v=y.keysApp||(y.keysApp={}));var c;(function(n){n[n.AUTH=0]="AUTH",n[n.HIDE=1]="HIDE",n[n.TRUST=2]="TRUST",n[n.NAME=0]="NAME",n[n.BLOCK=1]="BLOCK"})(c=y.relatedIndex||(y.relatedIndex={}))}},C={};function O(E){var y=C[E];if(y!==void 0)return y.exports;var x=C[E]={exports:{}};return F[E](x,x.exports,O),x.exports}var U={};(()=>{"use strict";var E=U;Object.defineProperty(E,"__esModule",{value:!0}),E.easyRun=void 0;var y=O("./src/protocol.js"),x=O("./src/protocol.js"),h=O("./src/decoder.js"),m=O("./src/auth.js"),p=O("./src/hide.js"),v=O("./lib/loader.js"),c=v.Loader,n=v.Libs,f=null,t={disable:!1,cache:!0,search:[],start:0,end:0,stamp:function(){return new Date().getTime()}},A={data:{},set:function(l,i,u){return A.data["".concat(l,"_").concat(i)]=u,!0},get:function(l,i){return A.data["".concat(l,"_").concat(i)]},clear:function(){A.data={}}},r={getAnchor:function(l,i){if(f===null)return i&&i({error:"No API to get data.",level:y.errorLevel.ERROR});var u=l[0],o=l[1];if(!t.cache){var _=A.get(u,o);if(_!==void 0)return i&&i(_)}o!==0?f.common.target(u,o,function(g){r.filterAnchor(g,i)}):f.common.latest(u,function(g){r.filterAnchor(g,i)})},filterAnchor:function(l,i){if(!l)return i&&i({error:"No such anchor.",level:y.errorLevel.ERROR});var u=l;if(u.error)return i&&i({error:u.error,level:y.errorLevel.ERROR});var o=l;if(t.disable||t.search.push([o.name,o.block]),t.cache||A.set(o.name,o.block,o),o.empty)return i&&i({error:"Empty anchor.",level:y.errorLevel.ERROR});if(!o.protocol)return i&&i({error:"No-protocol anchor."});var _=o.protocol;return _.type?i&&i(o):i&&i({error:"Not EasyProtocol anchor."})},decodeData:function(l,i){l.type=y.rawType.DATA;var u=l.data["".concat(l.location[0],"_").concat(l.location[1])],o=u.protocol;return o!==null&&o.call&&(l.call=o.call),i&&i(l)},decodeApp:function(l,i){l.type=y.rawType.APP;var u=l.data["".concat(l.location[0],"_").concat(l.location[1])],o=u.protocol;if(l.code=u.raw,o!==null&&o.lib)r.getLibs(o.lib,function(_){return l.libs=_,i&&i(l)});else return i&&i(l)},decodeLib:function(l,i){l.type=y.rawType.LIB;var u=l.data["".concat(l.location[0],"_").concat(l.location[1])],o=u.protocol;if(o!==null&&o.lib)r.getLibs(o.lib,function(_){return l.libs=_,i&&i(l)});else return i&&i(l)},getLibs:function(l,i){if(f===null)return i&&i({error:"No API to get data.",level:y.errorLevel.ERROR});var u={search:f.common.latest,target:f.common.target};n(l,u,i)},getHistory:function(l,i){var u=[],o=[];if(f===null)return o.push({error:"No API to get data.",level:y.errorLevel.ERROR}),i&&i(u,o);var _=l[0],g=l[1];f.common.history(_,function(b){var w=b;if(w.error)return o.push(w),i&&i(u,o);var T=b;return T.length===0?(o.push({error:"Empty history"}),i&&i(u,o)):i&&i(T,o)})},merge:function(l,i,u){if(f===null)return u&&u({error:"No API to get data.",level:y.errorLevel.ERROR});var o={hide:[],auth:null,trust:null,error:[],index:[null,null,null],map:{}};r.singleRule(l,i,x.relatedIndex.HIDE,function(_,g,b,w){var T;b!==null&&(o.index[x.relatedIndex.HIDE]=b);for(var N in g)o.map[N]=g[N];w.length!==0&&(T=o.error).push.apply(T,w),o.hide=_,r.singleRule(l,i,x.relatedIndex.AUTH,function(I,R,S,L){var H;S!==null&&(o.index[x.relatedIndex.AUTH]=S);for(var B in R)o.map[B]=R[B];L.length!==0&&(H=o.error).push.apply(H,L),o.auth=I,r.singleRule(l,i,x.relatedIndex.TRUST,function(P,D,J,M){var j;J!==null&&(o.index[x.relatedIndex.TRUST]=J);for(var $ in D)o.map[$]=D[$];return M.length!==0&&(j=o.error).push.apply(j,M),o.trust=P,u&&u(o)})})})},singleRule:function(l,i,u,o){var _=null,g={},b=null,w=[];switch(u){case x.relatedIndex.HIDE:(0,p.checkHide)(l,i,function(T){if(T.anchor===null&&T.list!==null)return _=T.list,o&&o(_,g,b,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!1,function(N,I,R){_=N;for(var S in I)g[S]=I[S];return w.push.apply(w,R),o&&o(_,g,b,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(_,g,b,w)});break;case x.relatedIndex.AUTH:(0,m.checkAuth)(l,i,function(T){if(T.anchor===null&&T.list!==null)return _=T.list,o&&o(_,g,b,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!0,function(N,I,R){_=N;for(var S in I)g[S]=I[S];return w.push.apply(w,R),o&&o(_,g,b,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(_,g,b,w)});break;case x.relatedIndex.TRUST:(0,m.checkTrust)(l,i,function(T){if(T.anchor===null&&T.list!==null)return _=T.list,o&&o(_,g,b,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!0,function(N,I,R){_=N;for(var S in I)g[S]=I[S];return w.push.apply(w,R),o&&o(_,g,b,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(_,g,b,w)});break;default:w.push({error:"unknow related index."}),o&&o(_,g,b,w);break}},singleExtend:function(l,i,u){var o=null,_={},g=[],b=Array.isArray(l)?[l[0],0]:[l,0];i?r.getLatestDeclaredHidden(b,function(w,T){var N=w;N!==void 0&&N.error&&g.push(N),T!==void 0&&(_["".concat(T.name,"_").concat(T.block)]=T);var I=w,R={};if(Array.isArray(I))for(var S=0;S<I.length;S++)R[I[S]]=!0;r.getHistory([Array.isArray(l)?l[0]:l,0],function(L,H){H!==void 0&&g.push.apply(g,H);for(var B=0;B<L.length;B++){var P=L[B];if(_["".concat(P.name,"_").concat(P.block)]=P,!R[P.block]){if(!P.protocol||!P.raw||P.protocol.type!==y.rawType.DATA){g.push({error:"Not valid anchor. ".concat(P.name,":").concat(P.block)});continue}try{var D=JSON.parse(P.raw);o===null&&(o={});for(var J in D)o[J]=D[J]}catch{g.push({error:"JSON format failed. ".concat(P.name,":").concat(P.block)});continue}}}return u&&u(o,_,g)})}):r.getAnchor(Array.isArray(l)?l:[l,0],function(w){var T=w;if(T!==void 0&&T.error)return g.push(T),u&&u(o,_,g);var N=w;if(_["".concat(N.name,"_").concat(N.block)]=N,!N.protocol||!N.raw||N.protocol.type!==y.rawType.DATA)return g.push({error:"Not valid anchor."}),u&&u(o,_,g);try{return o=JSON.parse(N.raw),u&&u(o,_,g)}catch(I){return g.push({error:JSON.stringify(I)}),u&&u(o,_,g)}})},decodeHideAnchor:function(l){var i=[],u=l.protocol;if(u?.fmt==="json")try{var o=JSON.parse(l.raw);if(Array.isArray(o))for(var _=0;_<o.length;_++){var g=parseInt(o[_]);isNaN(g)||i.push(g)}}catch{return{error:"failed to parse JSON"}}return i},checkAuthority:function(l,i,u){if(i.type!==y.rawType.APP)return l.error.push({error:"Answer is not cApp."}),u&&u(l);var o=l.data["".concat(l.location[0],"_").concat(l.location[1])],_=o.signer,g=i.auth;if(g===void 0)return l.app=i,u&&u(l);if(r.empty(g))return l.app=i,u&&u(l);if(g[_]===void 0)return l.error.push({error:"No authority of caller."}),u&&u(l);if(g[_]===0)return l.app=i,u&&u(l);f?.common.block(function(b,w){return b>g[_]?(l.error.push({error:"Authority out of time."}),u&&u(l)):(l.app=i,u&&u(l))})},getLatestDeclaredHidden:function(l,i){r.getAnchor([l[0],0],function(u){var o=u;if(o.error)return i&&i([]);var _=u,g=_.protocol;if(g===null||!g.hide)return i&&i([]);if(Array.isArray(g.hide))return i&&i(g.hide);r.getAnchor([g.hide,0],function(b){var w=u;if(w.error)return i&&i([]);var T=b;if(T===null||!T.raw)return i&&i([],T);try{var N=JSON.parse(T.raw);return i&&i(N,T)}catch(I){return i&&i({error:I})}})})},isValidAnchor:function(l,i,u,o){var _=[],g=i.block,b=!1;if(Array.isArray(l)){for(var w=l,T=0;T<w.length;T++)if(g===w[T]){if(i.pre===0)return _.push({error:"Out of ".concat(i.name," limited")}),b=!0,u&&u(null,_,b);var N=(0,h.linkCreator)([i.name,i.pre],o);return u&&u(N,_,b)}return u&&u(null,_)}else{var I=[l,0];r.getAnchor(I,function(R){var S=r.decodeHideAnchor(R),L=S;L.error&&_.push(L);for(var H=S,B=0;B<H.length;B++)if(g===H[B]){if(i.pre===0)return _.push({error:"Out of ".concat(i.name," limited")}),b=!0,u&&u(null,_,b);var P=(0,h.linkCreator)([i.name,i.pre],o);return u&&u(P,_,b)}return u&&u(null,_,b)})}},getParams:function(l){for(var i={},u=l.split("&"),o=0;o<u.length;o++){var _=u[o],g=_.split("=");if(g.length!==2)return{error:"error parameter"};i[g[0]]=g[1]}return i},empty:function(l){for(var i in l)return!1;return!0}},e={};e[y.rawType.APP]=r.decodeApp,e[y.rawType.DATA]=r.decodeData,e[y.rawType.LIB]=r.decodeLib;var a=function(l,i,u,o,_){f===null&&i!==null&&(f=i);var g=(0,h.linkDecoder)(l);if(g.error)return u&&u(g);if(o===void 0)return r.getLatestDeclaredHidden(g.location,function(w,T){var N={type:y.rawType.NONE,location:[g.location[0],g.location[1]!==0?g.location[1]:0],error:[],data:{},index:[null,null,null]},I=w;if(I!==void 0&&I.error)return N.error.push(I),a(l,f,u,[]);var R=w;return a(l,f,u,R)});var b={type:y.rawType.NONE,location:[g.location[0],g.location[1]!==0?g.location[1]:0],error:[],data:{},index:[null,null,null],hide:o};g.param&&(b.parameter=g.param),r.getAnchor(g.location,function(w){var T=w;if(T.error)return b.error.push(T),u&&u(b);var N=w;if(b.location[1]===0&&(b.location[1]=N.block),b.data["".concat(b.location[0],"_").concat(b.location[1])]=N,N.protocol===null)return b.error.push({error:"No valid protocol"}),u&&u(b);var I=N.protocol.type?N.protocol.type:"";if(!e[I])return b.error.push({error:"Not easy protocol type"}),u&&u(b);if(N.protocol)r.isValidAnchor(o,N,function(S,L,H){var B;return(B=b.error).push.apply(B,L),H?u&&u(b):S!==null?a(S,f,u,o):R(I)},b.parameter===void 0?{}:b.parameter);else return R(I);function R(S){r.merge(N.name,N.protocol,function(L){var H;L.auth!==null&&(b.auth=L.auth),L.trust!==null&&(b.trust=L.trust),L.hide!=null&&L.hide.length!==0&&(b.hide=L.hide),L.error.length!==0&&(H=b.error).push.apply(H,L.error),L.index[x.relatedIndex.AUTH]!==null&&b.index&&(b.index[x.relatedIndex.AUTH]=L.index[x.relatedIndex.AUTH]),L.index[x.relatedIndex.HIDE]!==null&&b.index&&(b.index[x.relatedIndex.HIDE]=L.index[x.relatedIndex.HIDE]),L.index[x.relatedIndex.TRUST]!==null&&b.index&&(b.index[x.relatedIndex.TRUST]=L.index[x.relatedIndex.TRUST]);for(var B in L.map)b.data[B]=L.map[B];return e[S](b,function(P){if(P.call&&!_){var D=(0,h.linkCreator)(P.call,P.parameter===void 0?{}:P.parameter);return a(D,f,function(J){return r.checkAuthority(P,J,u)},o,!0)}else return u&&u(P)})})}})},s=function(l,i,u){t.search=[],t.start=t.stamp(),a(l,i,function(o){return t.disable||(o.debug=t),t.end=t.stamp(),A.clear(),u&&u(o)})},d=t.disable?a:s;E.easyRun=d})(),W.exports=U})()});var X=K((exports,module)=>{console.log(anchorJS);console.log(Polkadot);var config={error:"\x1B[36m%s\x1B[0m",success:"\x1B[36m%s\x1B[0m"},websocket=null,self={auto:F=>{if(websocket!==null)return F&&F();self.html(`Ready to link to server ${server}.`,"more");let C=Polkadot.ApiPromise,O=Polkadot.WsProvider,U=Polkadot.Keyring;C.create({provider:new O(server)}).then(E=>(self.html(`Linker to node [${server}] created.`,"more"),websocket=E,anchorJS.set(E),anchorJS.setKeyring(U),F&&F()))},decoder:F=>{let C={anchor:"plinth",server:"ws://127.0.0.1:9944"};if(!F)return C;let O=F.split("@");if(O.length===1)return C.anchor=O[0].substring(1),C;{C.server=O.pop();let U=O.join("@");return C.anchor=U.substring(1),C}},html:(F,C)=>{let O=document.getElementById(C),U=document.createTextNode(F);O.innerHTML="",O.appendChild(U)},hide:F=>{let C=document.getElementById(F);C.style.display="none"}},result=self.decoder(location.hash),linker=`anchor://${result.anchor}/`,server=result.server;self.html(result.anchor,"target");self.auto(()=>{let{easyRun}=V(),startAPI={common:{latest:anchorJS.latest,target:anchorJS.target,history:anchorJS.history,owner:anchorJS.owner,subcribe:anchorJS.subcribe,block:anchorJS.block}};easyRun(linker,startAPI,res=>{let js=res.libs.js,css=res.libs.css;eval(js);let head=document.getElementsByTagName("head")[0],style=document.createElement("style"),cmap=document.createTextNode(css);style.appendChild(cmap),head.appendChild(style);let block=res.location[1],name=res.location[0],key=`${name}_${block}`,anchor=res.data[key];self.html(`${name} on ${block.toLocaleString()}, signed by ${anchor.signer}`,"more"),self.hide("info")})})});X();})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
//!important This is the library for creating auth data
//!important This is the library for decoding anchor link
//!important This is the Typescript implement of Esay Protocol version 1.0.
//!important Easy Protocol is a simple protocol to launch cApp via Anchor network.
//!important All functions implement, but this implement only support JS with CSS application 
/*!****************************!*\
  !*** ./src/interpreter.js ***!
  \****************************/
//!important This is the library for Esay Protocol v1.0
//!important All data come from `Anchor Link`
//!important This implement extend `auth` and `hide` by salt way to load data
//!important, as support `declared hidden`, this function may redirect many times, be careful.
//!important, This is the loader of launcher such as `Plinth`.
//!important, Need to build, the index.html not support hight version JS
