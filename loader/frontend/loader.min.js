(()=>{var K=(B,C)=>()=>(C||B((C={exports:{}}).exports,C),C.exports);var V=K((G,W)=>{(()=>{var B={"./lib/loader.js":(E,y)=>{let x=null,h=null,m={getLibs:(p,v,c,n)=>{c||(c={}),n||(n=[]);let f=p.shift(),t=(Array.isArray(f)?f[0]:f).toLocaleLowerCase(),A=Array.isArray(f)?f[1]:0;if(c[t])return m.getLibs(p,v,c,n);m.getAnchor(t,A,(r,e)=>{if(c[r]=e||{error:"no such anchor"},!e.protocol||!e.protocol.ext&&!e.protocol.lib)n.push(r);else{let a={entry:r,lib:e.protocol&&e.protocol.lib?e.protocol.lib:[],ext:e.protocol&&e.protocol.ext?e.protocol.ext:[]};n.push(a)}if(e.protocol&&e.protocol.ext)for(let a=e.protocol.ext.length;a>0;a--)p.unshift(e.protocol.ext[a-1]);if(e.protocol&&e.protocol.lib)for(let a=e.protocol.lib.length;a>0;a--)p.unshift(e.protocol.lib[a-1]);if(p.length===0)return v&&v(c,n);m.getLibs(p,v,c,n)})},getAnchor:(p,v,c)=>{if(!p)return c&&c(p,"");(v===0?x:h)(p,f=>{if(!f||!f.owner)return c&&c(p,"");if(!f.empty){let t={key:f.name,raw:f.raw,protocol:f.protocol};return c&&c(p,t)}})},decodeLib:p=>{let v={type:"error",data:""};if(p.error)return v.error=p.error,v;if(!p.protocol)return v.error="Unexcept data format",v;let c=p.protocol;return c.fmt?(v.type=c.fmt,p.raw.substr(0,2).toLowerCase()==="0x"?v.data=decodeURIComponent(p.raw.slice(2).replace(/\s+/g,"").replace(/[0-9a-f]{2}/g,"%$&")):v.data=p.raw,v):(v.error="Anchor format lost",v)},getComplexOrder:(p,v,c,n)=>{if(c||(c=[]),n||(n=[]),v[p]===!0&&n.length===0)return c;let f=v[p],t=n.length!==0?n[n.length-1]:null,A=t!==null&&t.name===p?n.pop():null;if(f.lib&&f.lib.length>0){if(A===null)for(let r=0;r<f.lib.length;r++){let e=f.lib[r];if(v[e]===!0)c.push(e);else return n.push({lib:r,name:p}),m.getComplexOrder(e,v,c,n)}else if(A.lib!==void 0&&A.lib!==f.lib.length)for(let r=A.lib+1;r<f.lib.length;r++){let e=f.lib[r];if(v[e]===!0)c.push(e);else return n.push({lib:r,name:p}),m.getComplexOrder(e,v,c,n)}}if(A===null&&c.push(p),f.ext&&f.ext.length>0)if(A!==null){if(A.ext!==void 0&&A.ext!==f.ext.length)for(let r=A.ext+1;r<f.ext.length;r++){let e=f.ext[r];if(v[e]===!0)c.push(e);else return n.push({ext:r,name:p}),m.getComplexOrder(e,v,c,n)}}else for(let r=0;r<f.ext.length;r++){let e=f.ext[r];if(v[e]===!0)c.push(e);else return n.push({ext:r,name:p}),m.getComplexOrder(e,v,c,n)}if(n.length!==0){let r=n[n.length-1];return m.getComplexOrder(r.name,v,c,n)}return c},mergeOrder:p=>{let v={},c={},n={},f=[];for(let t=0;t<p.length;t++){let A=p[t];typeof A!="string"&&A.entry!==void 0?(v[A.entry]=!0,c[A.entry]=A):c[A]=!0}for(let t=0;t<p.length;t++){let A=p[t];if(typeof A=="string"||A instanceof String){if(n[A])continue;f.push(A),n[A]=!0}else{if(A.lib&&A.lib.length>0)for(let r=0;r<A.lib.length;r++){let e=A.lib[r];if(!n[e])if(v[e]){let a=m.getComplexOrder(e,c);console.log(`${e}:${JSON.stringify(a)}`);for(let s=0;s<a.length;s++){let d=a[s];n[d]||(f.push(d),n[d]=!0)}}else f.push(e),n[e]=!0}if(n[A.entry]||(f.push(A.entry),n[A.entry]=!0),A.ext&&A.ext.length>0)for(let r=0;r<A.ext.length;r++){let e=A.ext[r];if(!n[e])if(v[e]){let a=m.getComplexOrder(e,c);for(let s=0;s<a.length;s++){let d=a[s];n[d]||(f.push(d),n[d]=!0)}}else f.push(e),n[e]=!0}}}return f},regroupCode:(p,v)=>{let c=m.decodeLib,n="",f="",t={},A={},r=!1,e=m.mergeOrder(v);for(let a=0;a<e.length;a++){let s=e[a];if(t[s])continue;let d=p[s],i=c(d);if(t[s]=!0,i.error){A[s]=i.error,r=!0;continue}n+=i.type==="js"?i.data:"",f+=i.type==="css"?i.data:""}return{js:n,css:f,failed:A,order:e,error:r}}};y.Loader=(p,v,c)=>{x=v.search,h=v.target,m.getLibs(p,c)},y.Libs=(p,v,c)=>{x=v.search,h=v.target,m.getLibs(p,(n,f)=>{let t=m.regroupCode(n,f);return c&&c(t)})}},"./node_modules/charenc/charenc.js":E=>{var y={utf8:{stringToBytes:function(x){return y.bin.stringToBytes(unescape(encodeURIComponent(x)))},bytesToString:function(x){return decodeURIComponent(escape(y.bin.bytesToString(x)))}},bin:{stringToBytes:function(x){for(var h=[],m=0;m<x.length;m++)h.push(x.charCodeAt(m)&255);return h},bytesToString:function(x){for(var h=[],m=0;m<x.length;m++)h.push(String.fromCharCode(x[m]));return h.join("")}}};E.exports=y},"./node_modules/crypt/crypt.js":E=>{(function(){var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",x={rotl:function(h,m){return h<<m|h>>>32-m},rotr:function(h,m){return h<<32-m|h>>>m},endian:function(h){if(h.constructor==Number)return x.rotl(h,8)&16711935|x.rotl(h,24)&4278255360;for(var m=0;m<h.length;m++)h[m]=x.endian(h[m]);return h},randomBytes:function(h){for(var m=[];h>0;h--)m.push(Math.floor(Math.random()*256));return m},bytesToWords:function(h){for(var m=[],p=0,v=0;p<h.length;p++,v+=8)m[v>>>5]|=h[p]<<24-v%32;return m},wordsToBytes:function(h){for(var m=[],p=0;p<h.length*32;p+=8)m.push(h[p>>>5]>>>24-p%32&255);return m},bytesToHex:function(h){for(var m=[],p=0;p<h.length;p++)m.push((h[p]>>>4).toString(16)),m.push((h[p]&15).toString(16));return m.join("")},hexToBytes:function(h){for(var m=[],p=0;p<h.length;p+=2)m.push(parseInt(h.substr(p,2),16));return m},bytesToBase64:function(h){for(var m=[],p=0;p<h.length;p+=3)for(var v=h[p]<<16|h[p+1]<<8|h[p+2],c=0;c<4;c++)p*8+c*6<=h.length*8?m.push(y.charAt(v>>>6*(3-c)&63)):m.push("=");return m.join("")},base64ToBytes:function(h){h=h.replace(/[^A-Z0-9+\/]/ig,"");for(var m=[],p=0,v=0;p<h.length;v=++p%4)v!=0&&m.push((y.indexOf(h.charAt(p-1))&Math.pow(2,-2*v+8)-1)<<v*2|y.indexOf(h.charAt(p))>>>6-v*2);return m}};E.exports=x})()},"./node_modules/is-buffer/index.js":E=>{E.exports=function(h){return h!=null&&(y(h)||x(h)||!!h._isBuffer)};function y(h){return!!h.constructor&&typeof h.constructor.isBuffer=="function"&&h.constructor.isBuffer(h)}function x(h){return typeof h.readFloatLE=="function"&&typeof h.slice=="function"&&y(h.slice(0,0))}},"./node_modules/md5/md5.js":(E,y,x)=>{(function(){var h=x("./node_modules/crypt/crypt.js"),m=x("./node_modules/charenc/charenc.js").utf8,p=x("./node_modules/is-buffer/index.js"),v=x("./node_modules/charenc/charenc.js").bin,c=function(n,f){n.constructor==String?f&&f.encoding==="binary"?n=v.stringToBytes(n):n=m.stringToBytes(n):p(n)?n=Array.prototype.slice.call(n,0):!Array.isArray(n)&&n.constructor!==Uint8Array&&(n=n.toString());for(var t=h.bytesToWords(n),A=n.length*8,r=1732584193,e=-271733879,a=-1732584194,s=271733878,d=0;d<t.length;d++)t[d]=(t[d]<<8|t[d]>>>24)&16711935|(t[d]<<24|t[d]>>>8)&4278255360;t[A>>>5]|=128<<A%32,t[(A+64>>>9<<4)+14]=A;for(var i=c._ff,l=c._gg,u=c._hh,o=c._ii,d=0;d<t.length;d+=16){var b=r,g=e,_=a,w=s;r=i(r,e,a,s,t[d+0],7,-680876936),s=i(s,r,e,a,t[d+1],12,-389564586),a=i(a,s,r,e,t[d+2],17,606105819),e=i(e,a,s,r,t[d+3],22,-1044525330),r=i(r,e,a,s,t[d+4],7,-176418897),s=i(s,r,e,a,t[d+5],12,1200080426),a=i(a,s,r,e,t[d+6],17,-1473231341),e=i(e,a,s,r,t[d+7],22,-45705983),r=i(r,e,a,s,t[d+8],7,1770035416),s=i(s,r,e,a,t[d+9],12,-1958414417),a=i(a,s,r,e,t[d+10],17,-42063),e=i(e,a,s,r,t[d+11],22,-1990404162),r=i(r,e,a,s,t[d+12],7,1804603682),s=i(s,r,e,a,t[d+13],12,-40341101),a=i(a,s,r,e,t[d+14],17,-1502002290),e=i(e,a,s,r,t[d+15],22,1236535329),r=l(r,e,a,s,t[d+1],5,-165796510),s=l(s,r,e,a,t[d+6],9,-1069501632),a=l(a,s,r,e,t[d+11],14,643717713),e=l(e,a,s,r,t[d+0],20,-373897302),r=l(r,e,a,s,t[d+5],5,-701558691),s=l(s,r,e,a,t[d+10],9,38016083),a=l(a,s,r,e,t[d+15],14,-660478335),e=l(e,a,s,r,t[d+4],20,-405537848),r=l(r,e,a,s,t[d+9],5,568446438),s=l(s,r,e,a,t[d+14],9,-1019803690),a=l(a,s,r,e,t[d+3],14,-187363961),e=l(e,a,s,r,t[d+8],20,1163531501),r=l(r,e,a,s,t[d+13],5,-1444681467),s=l(s,r,e,a,t[d+2],9,-51403784),a=l(a,s,r,e,t[d+7],14,1735328473),e=l(e,a,s,r,t[d+12],20,-1926607734),r=u(r,e,a,s,t[d+5],4,-378558),s=u(s,r,e,a,t[d+8],11,-2022574463),a=u(a,s,r,e,t[d+11],16,1839030562),e=u(e,a,s,r,t[d+14],23,-35309556),r=u(r,e,a,s,t[d+1],4,-1530992060),s=u(s,r,e,a,t[d+4],11,1272893353),a=u(a,s,r,e,t[d+7],16,-155497632),e=u(e,a,s,r,t[d+10],23,-1094730640),r=u(r,e,a,s,t[d+13],4,681279174),s=u(s,r,e,a,t[d+0],11,-358537222),a=u(a,s,r,e,t[d+3],16,-722521979),e=u(e,a,s,r,t[d+6],23,76029189),r=u(r,e,a,s,t[d+9],4,-640364487),s=u(s,r,e,a,t[d+12],11,-421815835),a=u(a,s,r,e,t[d+15],16,530742520),e=u(e,a,s,r,t[d+2],23,-995338651),r=o(r,e,a,s,t[d+0],6,-198630844),s=o(s,r,e,a,t[d+7],10,1126891415),a=o(a,s,r,e,t[d+14],15,-1416354905),e=o(e,a,s,r,t[d+5],21,-57434055),r=o(r,e,a,s,t[d+12],6,1700485571),s=o(s,r,e,a,t[d+3],10,-1894986606),a=o(a,s,r,e,t[d+10],15,-1051523),e=o(e,a,s,r,t[d+1],21,-2054922799),r=o(r,e,a,s,t[d+8],6,1873313359),s=o(s,r,e,a,t[d+15],10,-30611744),a=o(a,s,r,e,t[d+6],15,-1560198380),e=o(e,a,s,r,t[d+13],21,1309151649),r=o(r,e,a,s,t[d+4],6,-145523070),s=o(s,r,e,a,t[d+11],10,-1120210379),a=o(a,s,r,e,t[d+2],15,718787259),e=o(e,a,s,r,t[d+9],21,-343485551),r=r+b>>>0,e=e+g>>>0,a=a+_>>>0,s=s+w>>>0}return h.endian([r,e,a,s])};c._ff=function(n,f,t,A,r,e,a){var s=n+(f&t|~f&A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._gg=function(n,f,t,A,r,e,a){var s=n+(f&A|t&~A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._hh=function(n,f,t,A,r,e,a){var s=n+(f^t^A)+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._ii=function(n,f,t,A,r,e,a){var s=n+(t^(f|~A))+(r>>>0)+a;return(s<<e|s>>>32-e)+f},c._blocksize=16,c._digestsize=16,E.exports=function(n,f){if(n==null)throw new Error("Illegal argument "+n);var t=h.wordsToBytes(c(n,f));return f&&f.asBytes?t:f&&f.asString?v.bytesToString(t):h.bytesToHex(t)}})()},"./src/auth.js":(E,y,x)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.checkTrust=y.checkAuth=y.easyAuth=void 0;var h=x("./node_modules/md5/md5.js"),m=function(c,n,f){};y.easyAuth=m;var p=function(c,n,f){var t={list:null,anchor:null};return n.auth?typeof n.auth=="string"||Array.isArray(n.auth)?t.anchor=n.auth:t.list=n.auth:n.salt&&(t.anchor=h(c+n.salt[0])),f&&f(t)};y.checkAuth=p;var v=function(c,n,f){var t={list:null,anchor:null};return n.trust?typeof n.trust=="string"||Array.isArray(n.trust)?t.anchor=n.trust:t.list=n.trust:n.salt&&(t.anchor=h(c+n.salt[0])),f&&f(t)};y.checkTrust=v},"./src/decoder.js":(E,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.linkDecoder=y.linkCreator=void 0;var x={check:!1,utf8:!0,pre:"anchor://"},h={getParams:function(v){for(var c={},n=v.split("&"),f=0;f<n.length;f++){var t=n[f],A=t.split("=");if(A.length!==2)return{error:"error parameter"};c[A[0]]=A[1]}return c},combineParams:function(v){if(!v)return"";var c=[];for(var n in v)c.push("".concat(n,"=").concat(v[n]));return c.length===0?"":c.join("&")}},m=function(v,c){var n=h.combineParams(c);return Array.isArray(v)?v[1]!==0?"".concat(x.pre).concat(v[0],"/").concat(v[1]).concat(n&&"?"+n):"".concat(x.pre).concat(v[0]).concat(n&&"?"+n):"".concat(x.pre).concat(v).concat(n&&"?"+n)};y.linkCreator=m;var p=function(v){var c={location:["",0]},n=v.toLocaleLowerCase(),f=x.pre;if(n.length<=f.length+1)return{error:"invalid string"};var t=n.substring(0,f.length);if(t!==f)return{error:"invalid protocol"};var A=n.substring(f.length,n.length),r=A.split("?");if(r.length>2)return{error:"error request, please check anchor name"};var e=r.length!==1;if(e){var a=h.getParams(r[1]);if(a.error)return a;c.param=h.getParams(r[1])}A=r[0];for(var s=A.split("/"),d=[],i=0;i<s.length;i++)s[i]!==""&&d.push(s[i]);if(d.length===1)c.location[0]=d[0],c.location[1]=0;else{var l=d.pop(),u=parseInt(l);if(isNaN(u))return{error:"block number error"};c.location[1]=u,c.location[0]=d.join("/")}return c};y.linkDecoder=p},"./src/hide.js":(E,y,x)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.checkHide=y.easyHide=void 0;var h=x("./node_modules/md5/md5.js"),m=function(v){};y.easyHide=m;var p=function(v,c,n){var f={list:null,anchor:null};return c.hide?typeof c.hide=="string"?f.anchor=c.hide:Array.isArray(c.hide)&&(f.list=c.hide):c.salt&&(f.anchor=h(v+c.salt[1])),n&&n(f)};y.checkHide=p},"./src/protocol.js":(E,y)=>{"use strict";Object.defineProperty(y,"__esModule",{value:!0}),y.relatedIndex=y.keysApp=y.codeType=y.formatType=y.rawType=y.errorLevel=void 0;var x;(function(n){n.ERROR="error",n.WARN="warning",n.UNEXCEPT="unexcept"})(x=y.errorLevel||(y.errorLevel={}));var h;(function(n){n.DATA="data",n.APP="app",n.LIB="lib",n.NONE="unknow"})(h=y.rawType||(y.rawType={}));var m;(function(n){n.JAVASCRIPT="js",n.CSS="css",n.MARKDOWN="md",n.JSON="json",n.MIX="mix",n.NONE=""})(m=y.formatType||(y.formatType={}));var p;(function(n){n.ASCII="ascii",n.UTF8="utf8",n.HEX="hex",n.NONE=""})(p=y.codeType||(y.codeType={}));var v;(function(n){})(v=y.keysApp||(y.keysApp={}));var c;(function(n){n[n.AUTH=0]="AUTH",n[n.HIDE=1]="HIDE",n[n.TRUST=2]="TRUST",n[n.NAME=0]="NAME",n[n.BLOCK=1]="BLOCK"})(c=y.relatedIndex||(y.relatedIndex={}))}},C={};function R(E){var y=C[E];if(y!==void 0)return y.exports;var x=C[E]={exports:{}};return B[E](x,x.exports,R),x.exports}var U={};(()=>{"use strict";var E=U;Object.defineProperty(E,"__esModule",{value:!0}),E.easyRun=void 0;var y=R("./src/protocol.js"),x=R("./src/protocol.js"),h=R("./src/decoder.js"),m=R("./src/auth.js"),p=R("./src/hide.js"),v=R("./lib/loader.js"),c=v.Loader,n=v.Libs,f=null,t={disable:!1,cache:!0,search:[],start:0,end:0,stamp:function(){return new Date().getTime()}},A={data:{},set:function(i,l,u){return A.data["".concat(i,"_").concat(l)]=u,!0},get:function(i,l){return A.data["".concat(i,"_").concat(l)]},clear:function(){A.data={}}},r={getAnchor:function(i,l){if(f===null)return l&&l({error:"No API to get data.",level:y.errorLevel.ERROR});var u=i[0],o=i[1];if(!t.cache){var b=A.get(u,o);if(b!==void 0)return l&&l(b)}o!==0?f.common.target(u,o,function(g){r.filterAnchor(g,l)}):f.common.latest(u,function(g){r.filterAnchor(g,l)})},filterAnchor:function(i,l){if(!i)return l&&l({error:"No such anchor.",level:y.errorLevel.ERROR});var u=i;if(u.error)return l&&l({error:u.error,level:y.errorLevel.ERROR});var o=i;if(t.disable||t.search.push([o.name,o.block]),t.cache||A.set(o.name,o.block,o),o.empty)return l&&l({error:"Empty anchor.",level:y.errorLevel.ERROR});if(!o.protocol)return l&&l({error:"No-protocol anchor."});var b=o.protocol;return b.type?l&&l(o):l&&l({error:"Not EasyProtocol anchor."})},decodeData:function(i,l){i.type=y.rawType.DATA;var u=i.data["".concat(i.location[0],"_").concat(i.location[1])],o=u.protocol;return o!==null&&o.call&&(i.call=o.call),l&&l(i)},decodeApp:function(i,l){i.type=y.rawType.APP;var u=i.data["".concat(i.location[0],"_").concat(i.location[1])],o=u.protocol;if(i.code=u.raw,o!==null&&o.lib)r.getLibs(o.lib,function(b){return i.libs=b,l&&l(i)});else return l&&l(i)},decodeLib:function(i,l){i.type=y.rawType.LIB;var u=i.data["".concat(i.location[0],"_").concat(i.location[1])],o=u.protocol;if(o!==null&&o.lib)r.getLibs(o.lib,function(b){return i.libs=b,l&&l(i)});else return l&&l(i)},getLibs:function(i,l){if(f===null)return l&&l({error:"No API to get data.",level:y.errorLevel.ERROR});var u={search:f.common.latest,target:f.common.target};n(i,u,l)},getHistory:function(i,l){var u=[],o=[];if(f===null)return o.push({error:"No API to get data.",level:y.errorLevel.ERROR}),l&&l(u,o);var b=i[0],g=i[1];f.common.history(b,function(_){var w=_;if(w.error)return o.push(w),l&&l(u,o);var T=_;return T.length===0?(o.push({error:"Empty history"}),l&&l(u,o)):l&&l(T,o)})},merge:function(i,l,u){if(f===null)return u&&u({error:"No API to get data.",level:y.errorLevel.ERROR});var o={hide:[],auth:null,trust:null,error:[],index:[null,null,null],map:{}};r.singleRule(i,l,x.relatedIndex.HIDE,function(b,g,_,w){var T;_!==null&&(o.index[x.relatedIndex.HIDE]=_);for(var N in g)o.map[N]=g[N];w.length!==0&&(T=o.error).push.apply(T,w),o.hide=b,r.singleRule(i,l,x.relatedIndex.AUTH,function(I,O,S,L){var H;S!==null&&(o.index[x.relatedIndex.AUTH]=S);for(var F in O)o.map[F]=O[F];L.length!==0&&(H=o.error).push.apply(H,L),o.auth=I,r.singleRule(i,l,x.relatedIndex.TRUST,function(P,D,J,j){var M;J!==null&&(o.index[x.relatedIndex.TRUST]=J);for(var $ in D)o.map[$]=D[$];return j.length!==0&&(M=o.error).push.apply(M,j),o.trust=P,u&&u(o)})})})},singleRule:function(i,l,u,o){var b=null,g={},_=null,w=[];switch(u){case x.relatedIndex.HIDE:(0,p.checkHide)(i,l,function(T){if(T.anchor===null&&T.list!==null)return b=T.list,o&&o(b,g,_,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!1,function(N,I,O){b=N;for(var S in I)g[S]=I[S];return w.push.apply(w,O),o&&o(b,g,_,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(b,g,_,w)});break;case x.relatedIndex.AUTH:(0,m.checkAuth)(i,l,function(T){if(T.anchor===null&&T.list!==null)return b=T.list,o&&o(b,g,_,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!0,function(N,I,O){b=N;for(var S in I)g[S]=I[S];return w.push.apply(w,O),o&&o(b,g,_,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(b,g,_,w)});break;case x.relatedIndex.TRUST:(0,m.checkTrust)(i,l,function(T){if(T.anchor===null&&T.list!==null)return b=T.list,o&&o(b,g,_,w);if(T.anchor!==null&&T.list===null)r.singleExtend(T.anchor,!0,function(N,I,O){b=N;for(var S in I)g[S]=I[S];return w.push.apply(w,O),o&&o(b,g,_,w)});else return T.anchor!==null&&T.list!==null&&w.push({error:"Format error."}),o&&o(b,g,_,w)});break;default:w.push({error:"unknow related index."}),o&&o(b,g,_,w);break}},singleExtend:function(i,l,u){var o=null,b={},g=[],_=Array.isArray(i)?[i[0],0]:[i,0];l?r.getLatestDeclaredHidden(_,function(w,T){var N=w;N!==void 0&&N.error&&g.push(N),T!==void 0&&(b["".concat(T.name,"_").concat(T.block)]=T);var I=w,O={};if(Array.isArray(I))for(var S=0;S<I.length;S++)O[I[S]]=!0;r.getHistory([Array.isArray(i)?i[0]:i,0],function(L,H){H!==void 0&&g.push.apply(g,H);for(var F=0;F<L.length;F++){var P=L[F];if(b["".concat(P.name,"_").concat(P.block)]=P,!O[P.block]){if(!P.protocol||!P.raw||P.protocol.type!==y.rawType.DATA){g.push({error:"Not valid anchor. ".concat(P.name,":").concat(P.block)});continue}try{var D=JSON.parse(P.raw);o===null&&(o={});for(var J in D)o[J]=D[J]}catch{g.push({error:"JSON format failed. ".concat(P.name,":").concat(P.block)});continue}}}return u&&u(o,b,g)})}):r.getAnchor(Array.isArray(i)?i:[i,0],function(w){var T=w;if(T!==void 0&&T.error)return g.push(T),u&&u(o,b,g);var N=w;if(b["".concat(N.name,"_").concat(N.block)]=N,!N.protocol||!N.raw||N.protocol.type!==y.rawType.DATA)return g.push({error:"Not valid anchor."}),u&&u(o,b,g);try{return o=JSON.parse(N.raw),u&&u(o,b,g)}catch(I){return g.push({error:JSON.stringify(I)}),u&&u(o,b,g)}})},decodeHideAnchor:function(i){var l=[],u=i.protocol;if(u?.fmt==="json")try{var o=JSON.parse(i.raw);if(Array.isArray(o))for(var b=0;b<o.length;b++){var g=parseInt(o[b]);isNaN(g)||l.push(g)}}catch{return{error:"failed to parse JSON"}}return l},checkAuthority:function(i,l,u){if(l.type!==y.rawType.APP)return i.error.push({error:"Answer is not cApp."}),u&&u(i);var o=i.data["".concat(i.location[0],"_").concat(i.location[1])],b=o.signer,g=l.auth;if(g===void 0)return i.app=l,u&&u(i);if(r.empty(g))return i.app=l,u&&u(i);if(g[b]===void 0)return i.error.push({error:"No authority of caller."}),u&&u(i);if(g[b]===0)return i.app=l,u&&u(i);f?.common.block(function(_,w){return _>g[b]?(i.error.push({error:"Authority out of time."}),u&&u(i)):(i.app=l,u&&u(i))})},getLatestDeclaredHidden:function(i,l){r.getAnchor([i[0],0],function(u){var o=u;if(o.error)return l&&l([]);var b=u,g=b.protocol;if(g===null||!g.hide)return l&&l([]);if(Array.isArray(g.hide))return l&&l(g.hide);r.getAnchor([g.hide,0],function(_){var w=u;if(w.error)return l&&l([]);var T=_;if(T===null||!T.raw)return l&&l([],T);try{var N=JSON.parse(T.raw);return l&&l(N,T)}catch(I){return l&&l({error:I})}})})},isValidAnchor:function(i,l,u,o){var b=[],g=l.block,_=!1;if(Array.isArray(i)){for(var w=i,T=0;T<w.length;T++)if(g===w[T]){if(l.pre===0)return b.push({error:"Out of ".concat(l.name," limited")}),_=!0,u&&u(null,b,_);var N=(0,h.linkCreator)([l.name,l.pre],o);return u&&u(N,b,_)}return u&&u(null,b)}else{var I=[i,0];r.getAnchor(I,function(O){var S=r.decodeHideAnchor(O),L=S;L.error&&b.push(L);for(var H=S,F=0;F<H.length;F++)if(g===H[F]){if(l.pre===0)return b.push({error:"Out of ".concat(l.name," limited")}),_=!0,u&&u(null,b,_);var P=(0,h.linkCreator)([l.name,l.pre],o);return u&&u(P,b,_)}return u&&u(null,b,_)})}},getParams:function(i){for(var l={},u=i.split("&"),o=0;o<u.length;o++){var b=u[o],g=b.split("=");if(g.length!==2)return{error:"error parameter"};l[g[0]]=g[1]}return l},empty:function(i){for(var l in i)return!1;return!0}},e={};e[y.rawType.APP]=r.decodeApp,e[y.rawType.DATA]=r.decodeData,e[y.rawType.LIB]=r.decodeLib;var a=function(i,l,u,o,b){f===null&&l!==null&&(f=l);var g=(0,h.linkDecoder)(i);if(g.error)return u&&u(g);if(o===void 0)return r.getLatestDeclaredHidden(g.location,function(w,T){var N={type:y.rawType.NONE,location:[g.location[0],g.location[1]!==0?g.location[1]:0],error:[],data:{},index:[null,null,null]},I=w;if(I!==void 0&&I.error)return N.error.push(I),a(i,f,u,[]);var O=w;return a(i,f,u,O)});var _={type:y.rawType.NONE,location:[g.location[0],g.location[1]!==0?g.location[1]:0],error:[],data:{},index:[null,null,null],hide:o};g.param&&(_.parameter=g.param),r.getAnchor(g.location,function(w){var T=w;if(T.error)return _.error.push(T),u&&u(_);var N=w;if(_.location[1]===0&&(_.location[1]=N.block),_.data["".concat(_.location[0],"_").concat(_.location[1])]=N,N.protocol===null)return _.error.push({error:"No valid protocol"}),u&&u(_);var I=N.protocol.type?N.protocol.type:"";if(!e[I])return _.error.push({error:"Not easy protocol type"}),u&&u(_);if(N.protocol)r.isValidAnchor(o,N,function(S,L,H){var F;return(F=_.error).push.apply(F,L),H?u&&u(_):S!==null?a(S,f,u,o):O(I)},_.parameter===void 0?{}:_.parameter);else return O(I);function O(S){r.merge(N.name,N.protocol,function(L){var H;L.auth!==null&&(_.auth=L.auth),L.trust!==null&&(_.trust=L.trust),L.hide!=null&&L.hide.length!==0&&(_.hide=L.hide),L.error.length!==0&&(H=_.error).push.apply(H,L.error),L.index[x.relatedIndex.AUTH]!==null&&_.index&&(_.index[x.relatedIndex.AUTH]=L.index[x.relatedIndex.AUTH]),L.index[x.relatedIndex.HIDE]!==null&&_.index&&(_.index[x.relatedIndex.HIDE]=L.index[x.relatedIndex.HIDE]),L.index[x.relatedIndex.TRUST]!==null&&_.index&&(_.index[x.relatedIndex.TRUST]=L.index[x.relatedIndex.TRUST]);for(var F in L.map)_.data[F]=L.map[F];return e[S](_,function(P){if(P.call&&!b){var D=(0,h.linkCreator)(P.call,P.parameter===void 0?{}:P.parameter);return a(D,f,function(J){return r.checkAuthority(P,J,u)},o,!0)}else return u&&u(P)})})}})},s=function(i,l,u){t.search=[],t.start=t.stamp(),a(i,l,function(o){return t.disable||(o.debug=t),t.end=t.stamp(),A.clear(),u&&u(o)})},d=t.disable?a:s;E.easyRun=d})(),W.exports=U})()});var X=K((exports,module)=>{var config={error:"\x1B[36m%s\x1B[0m",success:"\x1B[36m%s\x1B[0m"},websocket=null,self={auto:B=>{if(websocket!==null)return B&&B();self.html(`Ready to link to server ${server}.`,"more");let C=Polkadot.ApiPromise,R=Polkadot.WsProvider,U=Polkadot.Keyring;C.create({provider:new R(server)}).then(E=>(self.html(`Linker to node [${server}] created.`,"more"),websocket=E,anchorJS.set(E),anchorJS.setKeyring(U),B&&B()))},decoder:B=>{let C={anchor:"plinth",server:"ws://127.0.0.1:9944"};if(!B)return C;let R=B.split("@");if(R.length===1)return C.anchor=R[0].substring(1),C;{C.server=R.pop();let U=R.join("@");return C.anchor=U.substring(1),C}},html:(B,C)=>{let R=document.getElementById(C),U=document.createTextNode(B);R.innerHTML="",R.appendChild(U)},hide:B=>{let C=document.getElementById(B);C.style.display="none"}},result=self.decoder(location.hash),linker=`anchor://${result.anchor}/`,server=result.server;self.html(result.anchor,"target");self.auto(()=>{let{easyRun}=V(),startAPI={common:{latest:anchorJS.latest,target:anchorJS.target,history:anchorJS.history,owner:anchorJS.owner,subcribe:anchorJS.subcribe,block:anchorJS.block}};easyRun(linker,startAPI,res=>{if(res.libs&&res.libs.js){let js=res.libs.js;eval(js)}if(res.libs&&res.libs.css){let B=res.libs.css,C=document.getElementsByTagName("head")[0],R=document.createElement("style"),U=document.createTextNode(B);R.appendChild(U),C.appendChild(R)}res.code&&eval(res.code);let block=res.location[1],name=res.location[0],key=`${name}_${block}`,anchor=res.data[key];self.html(`${name} on ${block.toLocaleString()}, signed by ${anchor.signer}`,"more"),self.hide("info")})})});X();})();
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
//!important This is the library for creating auth data
//!important This is the library for decoding anchor link
//!important This is the Typescript implement of Esay Protocol version 1.0.
//!important Easy Protocol is a simple protocol to launch cApp via Anchor network.
//!important All functions implement, but this implement only support JS with CSS application 
/*!****************************!*\
  !*** ./src/interpreter.js ***!
  \****************************/
//!important This is the library for Esay Protocol v1.0
//!important All data come from `Anchor Link`
//!important This implement extend `auth` and `hide` by salt way to load data
//!important, as support `declared hidden`, this function may redirect many times, be careful.
//!important, This is the loader of launcher such as `Plinth`.
//!important, Need to build, the index.html not support hight version JS
